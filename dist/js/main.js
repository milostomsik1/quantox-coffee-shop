function getLatLng(e){userLatitude=e.coords.latitude,userLongitude=e.coords.longitude,console.log(userLatitude+" "+userLongitude),searchForCoffeeShops(userLatitude,userLongitude)}function getError(e){switch(e.code){case e.PERMISSION_DENIED:alert("User denied the request for Geolocation.");break;case e.POSITION_UNAVAILABLE:alert("Location information is unavailable.");break;case e.TIMEOUT:alert("The request to get user location timed out.");break;case e.UNKNOWN_ERROR:alert("An unknown error occurred.")}}function searchForCoffeeShops(e,o){var t="https://api.foursquare.com/v2/venues/search?client_id="+CLIENT_ID+"&client_secret="+CLIENT_SECRET+"&v=20130815&ll="+e+","+o+"&intent=browse&radius=1500&limit=10&query=coffee",s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText).response.venues;console.log(e),e.forEach(function(o,t){getCoffeeShopInfo(e[t].id,e[t].location.distance)})}},s.open("GET",t,!0),s.send()}function getCoffeeShopInfo(e,o){var t=new XMLHttpRequest,s="https://api.foursquare.com/v2/venues/"+e+"?client_id="+CLIENT_ID+"&client_secret="+CLIENT_SECRET+"&v=20130815";t.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText).response.venue;console.log(e);var t=e.photos.groups[0].items[0].prefix+"original"+e.photos.groups[0].items[0].suffix;console.log(t),coffeeShops.push({id:e.id,name:e.name,distance:o,isOpen:function(){return e.hasOwnProperty("hours")?e.hours.isOpen:"No hours defined."}(),picture:t,price:function(){return e.hasOwnProperty("price")?e.price.tier:9}()}),console.log(coffeeShops)}},t.open("GET",s,!0),t.send()}function sortByClosest(){coffeeShops.sort(function(e,o){return e.distance-o.distance}),console.log(coffeeShops)}function sortByCheapest(){coffeeShops.sort(function(e,o){return e.price-o.price}),console.log(coffeeShops)}var CLIENT_ID="SRSTKKDUOVCGTIYWEDEXYFGPPCFWSE25KA3PIJ3MLR0UFRWK",CLIENT_SECRET="CMTPSXLN4WZL0W2GT2GIYADXUKXFPAUKXDBKFYFXQHASS4KV",userLatitude,userLongitude;!function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(getLatLng,getError,{enableHighAccuracy:!0,timeout:5e3}):alert("Geolocation is not supported.")}();var coffeeShops=[];setTimeout(function(){sortByClosest()},3e3);