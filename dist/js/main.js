function getLatLng(e){userLatitude=e.coords.latitude,userLongitude=e.coords.longitude,searchForCoffeeShops(userLatitude,userLongitude),initMap(userLatitude,userLongitude),createUserMarker(userLatitude,userLongitude)}function getError(e){switch(e.code){case e.PERMISSION_DENIED:showErrorModal("Geolocation failed: please allow browser to access your location and refresh the page.");break;case e.POSITION_UNAVAILABLE:showErrorModal("Location information is unavailable.");break;case e.TIMEOUT:showErrorModal("The request to get user location timed out.");break;case e.UNKNOWN_ERROR:showErrorModal("An unknown error occurred.")}}function searchForCoffeeShops(e,t){var o="https://api.foursquare.com/v2/venues/search?client_id="+CLIENT_ID+"&client_secret="+CLIENT_SECRET+"&v=20130815&ll="+e+","+t+"&intent=browse&radius=9999&limit=10&query=coffee",n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText).response.venues;e.forEach(function(t,o){getCoffeeShopInfo(e[o].id,e[o].location.distance)})}},n.open("GET",o,!0),n.send()}function getCoffeeShopInfo(e,t){var o=new XMLHttpRequest,n="https://api.foursquare.com/v2/venues/"+e+"?client_id="+CLIENT_ID+"&client_secret="+CLIENT_SECRET+"&v=20130815";o.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText).response.venue,o=e.photos.groups[0].items[0].prefix+"500x300"+e.photos.groups[0].items[0].suffix,n={id:e.id,name:e.name,distance:t,isOpen:function(){return e.hasOwnProperty("hours")?e.hours.isOpen:"No hours defined."}(),picture:o,price:function(){return e.hasOwnProperty("price")?e.price.tier:9}(),lat:e.location.lat,lng:e.location.lng};coffeeShops.push(n),sortByDistance(),document.getElementById("coffee-shops-list").innerHTML="",coffeeShops.forEach(function(e){addCoffeeShopToList(e)}),createShopMarker(n)}},o.open("GET",n,!0),o.send()}function sortByDistance(){coffeeShops.sort(function(e,t){return e.distance-t.distance})}function sortByPrice(){coffeeShops.sort(function(e,t){return e.price-t.price})}function initMap(e,t){map=new google.maps.Map(document.getElementById("google-map"),{zoom:15,streetViewControl:!1,mapTypeControl:!1,center:{lat:e,lng:t}})}function createShopMarker(e){var t=new google.maps.Marker({position:{lat:e.lat,lng:e.lng},map:map,icon:"./assets/coffee-icon.png",title:e.name}),o=new google.maps.InfoWindow({content:"<span>"+e.name+"("+e.distance+"m)</span>"});t.addListener("click",function(){o.open(map,t)}),map.addListener("click",function(){o.close()})}function createUserMarker(e,t){new google.maps.Marker({position:{lat:e,lng:t},map:map,icon:"./assets/user-icon.png"})}function addCoffeeShopToList(e){if(!1!==e.isOpen){var t=document.getElementById("coffee-shops-list"),o=document.createElement("li"),n='<li class="coffee-shop"><img  class="coffee-shop__picture" src=" '+e.picture+' " alt=" '+e.name+' "><div class="coffee-shop__info"><h3 class="coffee-shop__name">'+e.name+" ("+e.distance+'m)</h3><p class="coffee-shop__price">'+function(){return e.price<=4?"Price: "+"$".repeat(e.price)+"<span class='coffee-shop__price--faded'>"+"$".repeat(4-e.price)+"</span>":"No pricing defined."}()+"</p></div></li>";o.innerHTML=n,t.appendChild(o)}}function showErrorModal(e){document.getElementById("modal").style.display="flex",document.getElementById("error-box__description").innerHTML=e}var CLIENT_ID="3DG1ROMCV35ATTHJNEUPDYFTFCSFN52DCTKMDLFLS5ZDAJVC",CLIENT_SECRET="WVS2J45N3P1IWEGDFZHVPZXOBELB5XR1VHNZQZ2KMAQVHRQO",userLatitude,userLongitude,map,uluru,coffeeShops=[];!function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(getLatLng,getError,{enableHighAccuracy:!0,timeout:3e4,maximumAge:6e5}):showErrorModal("Geolocation is not supported.")}(),document.getElementById("sort__distance").addEventListener("click",function(){document.getElementById("sort__distance").classList.add("sort__button--active"),document.getElementById("sort__price").classList.remove("sort__button--active"),sortByDistance(),document.getElementById("coffee-shops-list").innerHTML="",coffeeShops.forEach(function(e){addCoffeeShopToList(e)})}),document.getElementById("sort__price").addEventListener("click",function(){document.getElementById("sort__price").classList.add("sort__button--active"),document.getElementById("sort__distance").classList.remove("sort__button--active"),sortByPrice(),document.getElementById("coffee-shops-list").innerHTML="",coffeeShops.forEach(function(e){addCoffeeShopToList(e)})});